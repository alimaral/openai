KÃœTÃœPHANELERÄ°N Ä°MPORT EDÄ°LMESÄ°
import pandas
import openai
import requests
import json

#EXCEL'Ä°N Ã‡EKÄ°LMESÄ° VE DÃœZENLENMESÄ°
â€‹
ali_excel = pd.read_excel("C:\\Users\\Ali\\Desktop\\Carpettex_Bullet Points_NL - Kopya.xlsx")
#ali_excel.dropna(how="any",inplace=True)
ali_excel.columns
Ã‡ekilen excel'den ilgili olan sÃ¼tunun verilerinin liste olarak kaydedilmesi
gpt_send_list = ali_excel.sort_values("NiederlÃ¤ndisch")["NiederlÃ¤ndisch"].tolist()
gpt_send_list = list(set(gpt_send_list))
gpt_send_list.sort()
GPT API'sine baÄŸlanmak ve alÄ±nan cevaplarÄ±n listeye kaydedilmesi
openai.api_key = "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" #API-KEY
openai.organization = "org-wYS7qABGZwCJIrG7SsM57GJB" #API-ORG ID
â€‹
#GPT'DEN ALINACAK CEVABA AÄ°T FONKSÄ°YON
def GPT_Response(text):
    response = openai.ChatCompletion.create(model="gpt-3.5-turbo-0301",
    messages=[
        {"role": "system", "content": text},
    ],
    temperature=0
    )
    response_txt = pd.DataFrame(response["choices"])["message"].values[0]["content"]
    return response_txt
        
#GPT'DEN ALINACAK CEVAPLARIN LÄ°STEYE YAZILMASI 
gpt_response_liste = []
for item in gpt_send_list:
    gpt_response_liste.append(GPT_Response(item).split("\n"))
Type Markdown and LaTeX: ğ›¼2
â€‹
â€‹
â€‹
index_list = list(set(ali_excel["NiederlÃ¤ndisch"].values))
â€‹
#Ä°NDEX LÄ°STESÄ°NÄ° VE BULLET_POÄ°NT LÄ°STESÄ°NÄ° EÅ ZAMANLI OLARAK FOR DÃ–NGÃœSÃœNDE DÃ–NDÃœRÃœP
#BOÅ EXCEL TABLOSUNDA HER BÄ°R Ä°NDEX Ä°Ã‡Ä°N DOLDURUYORUZ
â€‹
for index,item in zip(index_list, gpt_response_liste):
    ali_excel.loc[index, "Bullet_Points1":] = item
â€‹
â€‹
ali_excel_boÅŸ.sort_values(by="Posisyon",inplace=True)
ali_excel.to_excel("C:\\Users\\Ali\\Desktop\\Carpettex_Bullet Points_NL - Kopya.xlsx", index=False)
